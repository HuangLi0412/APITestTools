import jsonimport unittestfrom common.baseApi import baseApifrom common.readExcel import readExcelfrom common.readExcelData import readExcelDataclass testApi(unittest.TestCase):    def test_Api(self):        global apiData        path = baseApi.get_excel(self)        excel = readExcel(path)        baseUrl = baseApi.get_url(self)        caseId = excel.getCaseId        name = excel.getName        method = excel.getMethod        url = excel.getUrl        headers = excel.getHeaders        data = excel.getData        row = excel.getRows        sheetName = excel.getSheetName        for i in range(0, row - 1):            if (sheetName[i] == ''):                api = baseApi(method[i], baseUrl + url[i], 'null', headers[i])                apiResponse = api.baseApi()                apiMsg = api.getMessage(apiResponse)                apiData = api.getData(apiResponse)                apiStatus = api.getStatus(apiResponse)                if apiStatus == 1:                    print('{}--{}:测试成功,状态码:{}'.format(caseId[i], name[i], apiStatus))                else:                    print('{}--{}:测试失败,状态码:{},错误信息:{}'.format(caseId[i], name[i], apiStatus, apiMsg))            else:                excelData = readExcelData(path, sheetName[i])                caseData = data[i]                for j in range(0, excelData.getRows - 1):                    api = baseApi(method[i], baseUrl + url[i], json.dumps(caseData[j]), headers[i])                    apiResponse = api.baseApi()                    apiMsg = api.getMessage(apiResponse)                    apiData = api.getData(apiResponse)                    apiStatus = api.getStatus(apiResponse)                    if apiStatus == excelData.getExcepted[j]:                        print('{}--{} {}:测试成功,状态码:{}'.format(caseId[i], name[i], excelData.getCaseId[j], apiStatus))                    else:                        print('{}--{} {}:测试失败,状态码:{},错误信息:{}'.format(caseId[i], name[i], excelData.getCaseId[j],                                                                     apiStatus, apiMsg))